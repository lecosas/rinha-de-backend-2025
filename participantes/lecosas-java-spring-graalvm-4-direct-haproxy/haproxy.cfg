global
    log stdout format raw local0
    # similar scale to your nginx nofile limit
    maxconn 30000
    nbthread 4
    tune.maxaccept 64

defaults
    mode http
    log global
    option httplog
    option dontlognull

    # Keep connections alive; good for many short API calls
    option http-keep-alive

    # sensible, low-latency timeouts for APIs
    timeout http-request    5s
    timeout connect         2s
    timeout client          30s
    timeout server          30s
    timeout http-keep-alive 10s
    retries 1

frontend http_in
    bind *:9999
    default_backend app_back

backend app_back
    balance roundrobin

    # Reuse server (upstream) connections aggressively ~ nginx keepalive
    http-reuse aggressive

    server backend01 backend-01:8080 maxconn 4096
    server backend02 backend-02:8080 maxconn 4096
